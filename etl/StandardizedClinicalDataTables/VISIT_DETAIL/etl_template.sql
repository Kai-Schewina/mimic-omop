 WITH transfers AS (SELECT icustay_id as visit_detail_id, subject_id as person_id, intime::date as visit_start_date, intime as visit_start_datetime, outtime::date as visit_end_date, outtime as visit_end_datetime, curr_wardid as care_site_id, eventtype as discharge_to_source_value, hadm_id as visit_occurrence_id FROM mimic.transfers) 
 INSERT INTO omop.VISIT_DETAIL (visit_detail_id, person_id, visit_start_date, visit_start_datetime, visit_end_date, visit_end_datetime, care_site_id, discharge_to_source_value, visit_occurrence_id)
 SELECT transfers.visit_detail_id, transfers.person_id, transfers.visit_start_date, transfers.visit_start_datetime, transfers.visit_end_date, transfers.visit_end_datetime, transfers.care_site_id, transfers.discharge_to_source_value, transfers.visit_occurrence_id 
FROM transfers 